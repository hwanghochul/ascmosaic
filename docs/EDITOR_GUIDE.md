# AscMosaic 에디터 사용 가이드

이 문서는 AscMosaic 에디터를 사용하여 3D 모델과 ASCII 모자이크 필터를 설정하고, 생성된 HTML 코드를 프로젝트에 적용하는 방법을 설명합니다.

## 목차

1. [에디터 실행](#에디터-실행)
2. [기본 사용 방법](#기본-사용-방법)
3. [도형 설정](#도형-설정)
4. [텍스처 및 모델 설정](#텍스처-및-모델-설정)
5. [컨트롤 모드 설정](#컨트롤-모드-설정)
6. [카메라 설정](#카메라-설정)
7. [ASCII 모자이크 필터 설정](#ascii-모자이크-필터-설정)
8. [리소스 추가 방법 (FTP)](#리소스-추가-방법-ftp)
9. [HTML 코드 생성 및 적용](#html-코드-생성-및-적용)
10. [고급 기능](#고급-기능)

## 에디터 실행

### 1. 개발 서버 시작

터미널에서 다음 명령어를 실행합니다:

```bash
npm run dev
```

### 2. 브라우저에서 접속

브라우저에서 `http://localhost:5173` 또는 표시된 로컬 주소로 접속합니다.

에디터 화면이 표시되면 준비 완료입니다.

## 기본 사용 방법

### 화면 구성

에디터는 다음과 같은 섹션으로 구성되어 있습니다:

- **왼쪽 패널**: 도형, 텍스처, 컨트롤 모드 등 설정
- **중앙 캔버스**: 3D 모델 미리보기
- **오른쪽 패널**: HTML 코드 생성 및 복사

### 기본 워크플로우

1. **도형 선택**: 구, 큐브, 평면, GLB 모델 중 선택
2. **텍스처 설정**: 이미지 또는 비디오 텍스처 선택
3. **컨트롤 모드 설정**: 오비트, 틸트, 고정 중 선택
4. **필터 설정**: ASCII 모자이크 필터 옵션 조정
5. **HTML 코드 생성**: 설정된 내용을 HTML 코드로 생성
6. **코드 복사 및 적용**: 생성된 코드를 프로젝트에 적용

## 도형 설정

### 구 (Sphere)

1. **도형 선택**: "도형" 드롭다운에서 "구" 선택
2. **반지름 설정**: 슬라이더로 반지름 조정 (기본값: 2)
3. **세그먼트 설정**: 
   - 가로 세그먼트: 구의 가로 분할도 (기본값: 64)
   - 세로 세그먼트: 구의 세로 분할도 (기본값: 32)

**참고**: 구를 선택하면 가로/세로 크기 설정은 표시되지 않습니다.

### 큐브 (Cube)

1. **도형 선택**: "도형" 드롭다운에서 "큐브" 선택
2. **크기 설정**: 슬라이더로 한 변의 길이 조정 (기본값: 4)

**참고**: 큐브를 선택하면 반지름 설정은 표시되지 않습니다.

### 평면 (Plane)

1. **도형 선택**: "도형" 드롭다운에서 "평면" 선택
2. **가로 설정**: 슬라이더로 가로 크기 조정 (기본값: 4)
3. **세로 설정**: 슬라이더로 세로 크기 조정 (기본값: 4)

**참고**: 
- 평면을 선택하면 반지름 설정은 표시되지 않습니다.
- 평면은 양면 렌더링되어 어느 각도에서도 보입니다.
- 평면은 기본적으로 남쪽(-Z 방향)을 바라보는 상태로 생성됩니다.

### GLB 모델

1. **도형 선택**: "도형" 드롭다운에서 "GLB" 선택
2. **모델 선택**: "모델" 드롭다운에서 원하는 GLB 파일 선택
3. **모델 URL 직접 입력**: 드롭다운에 없는 경우 직접 URL 입력 가능

**참고**: GLB 모델은 `public/resource/` 폴더에 있어야 합니다.

### 공통 설정

- **크기 배율**: 모든 도형에 적용되는 전체 크기 배율 (기본값: 1.0)

## 텍스처 및 모델 설정

### 이미지 텍스처

1. **텍스처 타입**: "이미지" 선택
2. **텍스처 선택**: 드롭다운에서 원하는 이미지 선택
   - 지원 형식: JPG, PNG 등
   - 기본 텍스처: `earth.jpg`, `test.jpg` 등

### 비디오 텍스처

1. **텍스처 타입**: "비디오" 선택
2. **비디오 선택**: 드롭다운에서 원하는 비디오 선택
   - 지원 형식: MP4
   - 비디오는 자동으로 반복 재생됩니다

### 리소스 추가

리소스 파일을 추가하려면 [리소스 추가 방법 (FTP)](#리소스-추가-방법-ftp) 섹션을 참고하세요.

## 컨트롤 모드 설정

### 오비트 컨트롤 (Orbit)

마우스로 카메라를 회전하고 줌할 수 있는 모드입니다.

1. **컨트롤 모드**: "오비트" 선택
2. **조작 방법**:
   - **회전**: 마우스 드래그
   - **줌**: 마우스 휠

**설정 옵션** (코드에서만 설정 가능):
- `minDistance`: 최소 거리
- `maxDistance`: 최대 거리
- `rotateSpeed`: 회전 속도
- `zoomSpeed`: 줌 속도

### 틸트 컨트롤 (Tilt)

마우스 위치에 따라 모델이 기울어지는 모드입니다.

1. **컨트롤 모드**: "틸트" 선택
2. **조작 방법**: 마우스를 캔버스 위에서 움직이면 모델이 기울어집니다
3. **설정 옵션**:
   - **X축 반전**: 체크박스로 X축 반전 여부 설정
   - **Y축 반전**: 체크박스로 Y축 반전 여부 설정
   - **최대 기울임 각도**: 슬라이더로 최대 각도 설정 (기본값: 30도)
   - **스무스 속도**: 슬라이더로 부드러움 정도 설정 (기본값: 0.15)

**참고**: 틸트 컨트롤 설정은 틸트 모드일 때만 HTML 코드에 포함됩니다.

### 고정 모드 (Fixed)

카메라가 고정되어 사용자가 조작할 수 없는 모드입니다.

1. **컨트롤 모드**: "고정" 선택
2. 카메라 위치와 각도는 설정된 값으로 고정됩니다.

## 카메라 설정

에디터에서 카메라의 위치, 회전, 시야각을 직접 제어할 수 있습니다.

### 카메라 위치 (Position)

카메라의 3D 공간상 위치를 설정합니다.

1. **위치 X**: 카메라의 X축 위치 (범위: -20 ~ 20)
2. **위치 Y**: 카메라의 Y축 위치 (범위: -20 ~ 20)
3. **위치 Z**: 카메라의 Z축 위치 (범위: -20 ~ 20)

**참고**: 오비트 컨트롤 모드가 아닐 때만 직접 위치를 설정할 수 있습니다.

### 카메라 회전 (Rotation) - 오비트 모드

오비트 컨트롤 모드일 때 카메라의 회전과 거리를 설정합니다.

1. **회전 Theta (수평)**: 카메라의 수평 회전 각도 (범위: 0 ~ 360도)
2. **회전 Phi (수직)**: 카메라의 수직 회전 각도 (범위: 0 ~ 180도)
3. **거리**: 카메라와 타겟 사이의 거리 (범위: 오비트 컨트롤의 최소/최대 거리 범위 내)

**참고**: 오비트 컨트롤 모드일 때만 회전과 거리를 설정할 수 있습니다.

### 시야각 (FOV)

카메라의 시야각(Field of View)을 설정합니다.

1. **FOV 슬라이더**: 시야각을 조정합니다 (범위: 10 ~ 120도, 기본값: 50도)
2. 값이 클수록 더 넓은 시야를 보여줍니다
3. 값이 작을수록 더 좁은 시야(줌인 효과)를 보여줍니다

### 카메라 리셋

카메라를 기본 위치로 리셋합니다.

1. **카메라 리셋 버튼**: "카메라 리셋" 버튼을 클릭
2. 카메라가 모델의 중심을 바라보도록 리셋됩니다
3. 오비트 컨트롤 모드일 때는 설정된 최소/최대 거리 범위 내에서 리셋됩니다

**참고**: 
- 카메라 설정은 실시간으로 반영됩니다
- 설정한 카메라 상태는 URL에 저장되어 페이지를 새로고침해도 유지됩니다
- 모델을 변경해도 카메라 위치는 유지됩니다 (자동 리셋되지 않음)

## ASCII 모자이크 필터 설정

ASCII 모자이크 필터는 3D 모델을 ASCII 문자로 변환하여 모자이크 효과를 만듭니다.

### 필터 활성화/비활성화

1. **ASCII 필터 토글 버튼**: "ASCII 필터 켜기" / "ASCII 필터 끄기" 버튼 클릭
2. 필터가 켜지면 버튼이 초록색으로 변경됩니다.

### 필터 설정 옵션

필터가 활성화되면 다음 옵션들을 설정할 수 있습니다:

#### 픽셀 크기 (Mosaic Size)

- **설명**: 모자이크 셀의 크기 (픽셀 단위)
- **기본값**: 10
- **범위**: 1 ~ 50
- **효과**: 값이 작을수록 더 세밀한 모자이크, 값이 클수록 더 큰 셀

#### 셀 개수 (Cell Count)

- **설명**: 모자이크 셀 텍스처의 가로/세로 분할 개수
- **기본값**: 6 (6x6 = 36개 셀)
- **범위**: 1 ~ 12
- **효과**: 값이 클수록 더 다양한 패턴 사용 가능

#### 셀 텍스처 선택

- **설명**: 모자이크 셀로 사용할 텍스처 선택
- **옵션**: `mosaic_cell.png`, `mosaic_cell2.png`, `mosaic_cell_6x6.png` 등
- **추가 방법**: [리소스 추가 방법](#리소스-추가-방법-ftp) 참고

#### 세트 개수 (Set Count)

- **설명**: 사용할 셀 세트의 개수
- **기본값**: 1
- **범위**: 1 ~ 10
- **효과**: 여러 세트를 사용하면 더 다양한 패턴 생성

#### 세트 선택 모드

- **설명**: 셀 세트를 선택하는 방식
- **옵션**:
  - `first`: 첫 번째 세트만 사용
  - `random`: 랜덤하게 세트 선택
  - `cycle`: 세트를 순환하며 선택
  - `offsetRow`: 마우스 위치에 따라 세트 변경 (마우스에 가까운 셀부터 순차적으로 세트 변경)
- **기본값**: `first`

**세트변경 (offsetRow) 모드:**
- 마우스를 캔버스 위에서 움직이면 마우스 위치에 따라 세트가 변경됩니다
- 마우스에 가까운 셀부터 먼 셀 순서로 세트가 변경됩니다
- 마우스 영향 범위를 설정할 수 있습니다 (기본값: 80픽셀)
- 영향 범위는 항상 원형으로 적용됩니다 (캔버스 비율과 무관)

#### 노이즈 강도 (Noise Intensity)

- **설명**: 모자이크에 추가되는 노이즈의 강도
- **기본값**: 0 (노이즈 없음)
- **범위**: 0 ~ 100
- **효과**: 값이 클수록 더 많은 노이즈

#### 노이즈 FPS

- **설명**: 노이즈가 업데이트되는 초당 프레임 수
- **기본값**: 10
- **범위**: 1 ~ 60
- **효과**: 값이 클수록 노이즈가 더 빠르게 변화

#### 회피하기 (Avoid)

- **설명**: 마우스 위치에 따라 모자이크 셀이 마우스를 피하도록 이동하는 기능
- **활성화**: "회피하기" 체크박스를 체크
- **마우스 영향 범위**: 마우스 주변의 영향 범위 (기본값: 80픽셀, 범위: 20 ~ 200픽셀)
- **이동 강도**: 셀이 이동하는 거리 (기본값: 20픽셀, 범위: 5 ~ 100픽셀)
- **효과**: 마우스를 캔버스 위에서 움직이면 셀들이 마우스를 피하도록 움직입니다

**특징:**
- 이동 강도는 픽셀 단위로 설정됩니다 (화면 크기와 무관)
- 마우스 영향 범위는 항상 원형으로 적용됩니다 (캔버스 비율과 무관)
- 셀의 실제 이동 거리는 모든 방향에서 동일한 픽셀 거리로 적용됩니다
- 회피하기와 세트변경 기능을 동시에 사용할 수 있습니다
- 마우스가 캔버스 밖에 있을 때는 기능이 비활성화됩니다 (기본 위치: 화면 밖)

#### 세트변경 (Offset Row)

- **설명**: 마우스 위치에 따라 모자이크 셀의 세트가 변경되는 기능
- **활성화**: 세트 선택 모드를 "세트변경"으로 설정
- **마우스 영향 범위**: 마우스 주변의 영향 범위 (기본값: 80픽셀, 범위: 20 ~ 200픽셀)
- **효과**: 마우스에 가까운 셀부터 먼 셀 순서로 세트가 변경됩니다

**특징:**
- 마우스 영향 범위는 항상 원형으로 적용됩니다 (캔버스 비율과 무관)
- 회피하기 기능과 동시에 사용할 수 있습니다
- 마우스가 캔버스 밖에 있을 때는 기능이 비활성화됩니다 (기본 위치: 화면 밖)

## 리소스 추가 방법 (FTP)

에디터에서 사용할 텍스처, 비디오, GLB 모델을 추가하는 방법입니다.

### 1. FTP 접속

FTP 클라이언트(FileZilla, WinSCP 등)를 사용하여 서버에 접속합니다.

### 2. 리소스 폴더로 이동

서버의 다음 경로로 이동합니다:

```
/public/resource/
```

이 폴더에 다음 하위 폴더들이 있습니다:
- `cells/`: 모자이크 셀 텍스처 (선택사항, 직접 폴더에 업로드)
- 루트: 일반 텍스처, 비디오, GLB 모델

### 3. 파일 업로드

#### 텍스처 이미지 추가

1. 이미지 파일을 `public/resource/` 폴더에 업로드
2. 지원 형식: JPG, PNG 등
3. 예시: `my_texture.jpg` 업로드

#### 비디오 추가

1. 비디오 파일을 `public/resource/` 폴더에 업로드
2. 지원 형식: MP4
3. 예시: `my_video.mp4` 업로드

#### GLB 모델 추가

1. GLB 모델 파일을 `public/resource/` 폴더에 업로드
2. 지원 형식: GLB
3. 예시: `my_model.glb` 업로드

#### 모자이크 셀 텍스처 추가

1. 셀 텍스처 이미지를 `public/resource/` 폴더에 업로드
2. 권장 형식: PNG (투명도 지원)
3. 예시: `my_cell.png` 업로드

### 4. resource_list.json 수정

리소스 파일을 업로드한 후, `public/resource/resource_list.json` 파일을 수정해야 에디터에서 선택할 수 있습니다.

#### FTP로 JSON 파일 다운로드

1. FTP 클라이언트에서 `public/resource/resource_list.json` 파일을 로컬로 다운로드
2. 텍스트 에디터로 열기

#### JSON 파일 구조

```json
{
  "cells": ["mosaic_cell.png", "mosaic_cell2.png", "mosaic_cell_6x6.png"],
  "textures": ["earth.jpg", "test.jpg"],
  "video_textures": ["video.mp4"],
  "models": ["ball.glb", "house.glb"]
}
```

#### 항목 추가 방법

**텍스처 추가 예시:**

```json
{
  "cells": ["mosaic_cell.png", "mosaic_cell2.png", "mosaic_cell_6x6.png", "my_cell.png"],
  "textures": ["earth.jpg", "test.jpg", "my_texture.jpg"],
  "video_textures": ["video.mp4", "my_video.mp4"],
  "models": ["ball.glb", "house.glb", "my_model.glb"]
}
```

**주의사항:**
- 파일명은 정확히 일치해야 합니다 (대소문자 구분)
- 파일 확장자도 포함해야 합니다
- 쉼표(,)로 구분하며 마지막 항목 뒤에는 쉼표를 붙이지 않습니다
- JSON 형식이 올바른지 확인하세요 (따옴표, 중괄호 등)

#### JSON 파일 업로드

1. 수정한 JSON 파일을 FTP 클라이언트로 다시 업로드
2. 기존 파일을 덮어쓰기
3. 에디터를 새로고침하면 새로운 리소스가 드롭다운에 나타납니다

### 5. 확인

1. 에디터 페이지를 새로고침 (F5)
2. 해당 리소스 타입의 드롭다운에서 새로 추가한 파일이 표시되는지 확인
3. 선택하여 사용

## HTML 코드 생성 및 적용

에디터에서 설정한 내용을 HTML 코드로 생성하고 프로젝트에 적용하는 방법입니다.

### 1. HTML 코드 생성

#### 실시간 생성 모드 (권장)

1. **실시간 토글**: 오른쪽 패널의 "실시간" 체크박스가 켜져 있는지 확인
2. 설정을 변경하면 자동으로 HTML 코드가 업데이트됩니다

#### 수동 생성 모드

1. **실시간 토글**: "실시간" 체크박스를 끕니다
2. 설정을 변경합니다
3. **생성 버튼**: "생성" 버튼을 클릭하여 HTML 코드를 생성합니다

### 2. HTML 코드 확인

생성된 HTML 코드는 오른쪽 패널의 텍스트 영역에 표시됩니다.

**생성되는 코드 예시:**

```html
<!-- AscMosaic 캔버스 -->
<div class="canvas-container ascmosaic" style="width:800px;height:600px;" data-ascmosaic-config='{"shape":"sphere","radius":2,"textureUrl":"/resource/earth.jpg","cameraPosition":{"x":0,"y":0,"z":5},"cameraRotation":{"x":0,"y":0,"z":0}}'></div>

<!-- 
  여러 캔버스를 추가하는 경우:
  - 위의 <div class="canvas-container ascmosaic"> 태그는 각 캔버스마다 추가하세요
  - 아래의 <script> 태그는 페이지당 한 번만 추가하세요 (여러 캔버스가 있어도 스크립트는 한 번만 필요)
-->
<script type="module" src="./ascmosaic-app.js"></script>
```

### 3. 코드 복사

1. **복사 버튼**: "복사" 버튼을 클릭
2. 또는 텍스트 영역을 선택하여 Ctrl+C (Mac: Cmd+C)로 복사

### 4. 프로젝트에 적용

#### 방법 1: HTML 파일에 직접 추가

1. 프로젝트의 HTML 파일을 엽니다 (예: `index.html`)
2. 원하는 위치에 복사한 HTML 코드를 붙여넣습니다
3. `ascmosaic-app.js` 파일이 올바른 경로에 있는지 확인합니다

**경로 확인:**
- HTML 파일과 같은 폴더에 `ascmosaic-app.js`가 있으면: `src="./ascmosaic-app.js"`
- 다른 폴더에 있으면 경로를 수정: `src="../dist/ascmosaic-app.js"`

#### 방법 2: 여러 캔버스 추가

여러 개의 3D 캔버스를 같은 페이지에 추가할 수 있습니다:

```html
<!-- 첫 번째 캔버스 -->
<div class="canvas-container ascmosaic" style="width:800px;height:600px;" data-ascmosaic-config='{...}'></div>

<!-- 두 번째 캔버스 -->
<div class="canvas-container ascmosaic" style="width:400px;height:300px;" data-ascmosaic-config='{...}'></div>

<!-- 스크립트는 한 번만 추가 -->
<script type="module" src="./ascmosaic-app.js"></script>
```

**주의사항:**
- 각 캔버스마다 `<div class="ascmosaic">` 태그를 추가합니다
- `<script>` 태그는 페이지당 한 번만 추가합니다

#### 방법 3: 빌드된 파일 포함

프로젝트에 빌드된 파일을 포함해야 합니다:

1. **빌드 실행**: `npm run build`
2. **파일 복사**: `dist/ascmosaic-app.js` 파일을 프로젝트 폴더로 복사
3. **경로 설정**: HTML 코드의 `src` 속성을 올바른 경로로 수정

### 5. 새 창에서 미리보기

에디터에서 생성된 HTML 코드가 올바르게 작동하는지 확인:

1. **미리보기 버튼**: "새 창에서 미리보기" 버튼 클릭
2. 새 창이 열리며 설정한 내용이 표시됩니다
3. 문제가 있으면 에디터에서 설정을 수정하고 다시 생성

### 6. 배포

프로젝트를 배포할 때:

1. **빌드 파일 포함**: `ascmosaic-app.js` 파일이 서버에 업로드되어 있는지 확인
2. **리소스 파일 확인**: 사용한 텍스처, 비디오, 모델 파일이 `public/resource/` 폴더에 있는지 확인
3. **경로 확인**: HTML 코드의 경로가 서버 환경에 맞는지 확인

## 고급 기능

### URL 파라미터로 상태 복원

에디터는 URL 파라미터로 설정 상태를 저장하고 복원할 수 있습니다.

1. 에디터에서 설정을 변경하면 URL이 자동으로 업데이트됩니다
2. URL을 복사하여 공유하면 다른 사람도 같은 설정을 볼 수 있습니다
3. 브라우저를 새로고침해도 설정이 유지됩니다

**저장되는 설정:**
- 도형 및 텍스처 설정
- 컨트롤 모드 설정
- ASCII 모자이크 필터 설정 (회피하기, 세트변경 포함)
- **카메라 위치 및 회전 상태** (오비트 모드일 때)
- 카메라 FOV 설정

**참고**: 
- 카메라 상태는 오비트 컨트롤 모드일 때만 저장됩니다
- 모델을 변경해도 카메라 위치는 유지됩니다

### 코드 최적화

에디터는 생성되는 HTML 코드를 최적화합니다:

- **불필요한 파라미터 제거**: 기본값과 동일한 설정은 제외됩니다
- **도형별 필요한 파라미터만 포함**: 
  - 구: `radius`만 포함 (width, height 제외)
  - 큐브/평면: `radius` 제외
- **컨트롤 모드별 파라미터**: 틸트 모드가 아닐 때 틸트 관련 파라미터 제외

이로 인해 생성되는 코드가 더 컴팩트하고 읽기 쉬워집니다.

### 커스텀 설정

에디터에서 제공하지 않는 고급 설정은 생성된 HTML 코드를 직접 수정하여 적용할 수 있습니다:

1. HTML 코드를 복사합니다
2. `data-ascmosaic-config` 속성의 JSON을 수정합니다
3. 필요한 파라미터를 추가하거나 수정합니다

**예시: 오비트 컨트롤 고급 설정**

```json
{
  "shape": "sphere",
  "radius": 2,
  "controlMode": "orbit",
  "orbitControls": {
    "minDistance": 2,
    "maxDistance": 10,
    "rotateSpeed": 1.5,
    "zoomSpeed": 0.2
  }
}
```

## 문제 해결

### 리소스가 표시되지 않을 때

1. `resource_list.json` 파일이 올바르게 수정되었는지 확인
2. 파일명이 정확히 일치하는지 확인 (대소문자 구분)
3. 파일이 올바른 폴더에 업로드되었는지 확인
4. 브라우저 캐시를 지우고 새로고침

### HTML 코드가 작동하지 않을 때

1. `ascmosaic-app.js` 파일 경로가 올바른지 확인
2. 브라우저 콘솔에서 오류 메시지 확인
3. 파일이 서버에 올바르게 업로드되었는지 확인
4. 네트워크 탭에서 리소스 로딩 상태 확인

### 성능 문제

1. 큰 텍스처나 모델 파일은 최적화하여 사용
2. 모자이크 크기를 조정하여 성능 개선
3. 불필요한 필터 옵션 비활성화

## 추가 도움말

문제가 발생하거나 질문이 있으면 프로젝트 이슈 트래커를 확인하거나 개발자에게 문의하세요.
